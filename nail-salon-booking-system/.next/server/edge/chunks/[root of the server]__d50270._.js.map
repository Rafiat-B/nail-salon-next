{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/src/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { jwtVerify } from 'jose';\r\n\r\nconst SECRET_KEY = new TextEncoder().encode(process.env.JWT_SECRET || 'your_secret_key_here');\r\n\r\nexport async function middleware(req: NextRequest) {\r\n  const token = req.cookies.get('token')?.value;\r\n  console.log(\"üåê Middleware hit ‚Üí Path:\", req.nextUrl.pathname);\r\n  console.log(\"üç™ Token from cookie:\", token);\r\n\r\n  if (!token) {\r\n    console.log(\"‚ùå No token, redirecting...\");\r\n    return NextResponse.redirect(new URL('/login', req.url));\r\n  }\r\n\r\n  try {\r\n    const { payload } = await jwtVerify(token, SECRET_KEY);\r\n    console.log(\"‚úÖ JWT verified:\", payload);\r\n\r\n    const isAdminRoute = req.nextUrl.pathname.startsWith('/admin');\r\n    const isDashboardRoute = req.nextUrl.pathname.startsWith('/dashboard');\r\n\r\n    if (isAdminRoute && payload.role !== 'admin') {\r\n      console.log(\"‚ùå Not an admin ‚Äî redirecting\");\r\n      return NextResponse.redirect(new URL('/login', req.url));\r\n    }\r\n\r\n    if (isDashboardRoute && payload.role !== 'customer') {\r\n      console.log(\"‚ùå Not a customer ‚Äî redirecting\");\r\n      return NextResponse.redirect(new URL('/login', req.url));\r\n    }\r\n\r\n    return NextResponse.next();\r\n  } catch (error) {\r\n    console.error(\"üí• JWT verification failed:\", error);\r\n    return NextResponse.redirect(new URL('/login', req.url));\r\n  }\r\n}\r\n\r\nexport const config = {\r\n  matcher: ['/dashboard/:path*', '/admin/:path*'],\r\n};\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AADA;;;AAGA,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE/D,eAAe,WAAW,GAAgB;IAC/C,MAAM,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,UAAU;IACxC,QAAQ,GAAG,CAAC,6BAA6B,IAAI,OAAO,CAAC,QAAQ;IAC7D,QAAQ,GAAG,CAAC,yBAAyB;IAErC,IAAI,CAAC,OAAO;QACV,QAAQ,GAAG,CAAC;QACZ,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,GAAG;IACxD;IAEA,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAA,GAAA,uJAAA,CAAA,YAAS,AAAD,EAAE,OAAO;QAC3C,QAAQ,GAAG,CAAC,mBAAmB;QAE/B,MAAM,eAAe,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;QACrD,MAAM,mBAAmB,IAAI,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC;QAEzD,IAAI,gBAAgB,QAAQ,IAAI,KAAK,SAAS;YAC5C,QAAQ,GAAG,CAAC;YACZ,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,GAAG;QACxD;QAEA,IAAI,oBAAoB,QAAQ,IAAI,KAAK,YAAY;YACnD,QAAQ,GAAG,CAAC;YACZ,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,GAAG;QACxD;QAEA,OAAO,qLAAA,CAAA,eAAY,CAAC,IAAI;IAC1B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,IAAI,GAAG;IACxD;AACF;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAqB;KAAgB;AACjD"}},
    {"offset": {"line": 66, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}